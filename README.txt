# faults_3D
Code to calculate and plot faults and project faults to depth for immediate use in Coulomb 3.4. 

Version 1.1

Written by Zoe Mildon, 2016

Updated in 2018

Code is free to use for research purposes, please cite the following paper:
Mildon, Z. K., S. Toda, J. P. Faure Walker, and G. P. Roberts (2016), Evaluating models of Coulomb stress transfer- is variable fault geometry important?, Geophys. Res. Lett., 43, doi:10.1002/2016GL071128.

UPDATED VERSION:
Version 1.4 -  03/2021 - Manuel Diercks

# INPUTS:
Three input formats are supported:
1) A shapefile (in UTM coordinates) that contains all faults. It may contain more faults than to be modelled, faults can be selected within the workflow.
2) kml-files of all faults (stored in the 'Fault_traces' folder) AND a table (txt, csv, xlsx,...) that contains the properties of the faults
3) A kmz-file containing the fault traces and a table containing the fault properties

If kml or kmz import is chosen please specify the utmzone (UTM zone number) and utmhemi (hemisphere,'n' or 's') variables in the faults_3D file.

Required properties (either in the table or as attributes in the shape file) are:

fault_name - for kml import the name of the kml file must be the same as the fault_name
dip - dip angle
rake
dip_dir - dip direction (projection direction)
len - length of the fault (km)

Make sure that the field names are spelled exactly as given. The order of the columns may vary. Example files for each input type are included in the 'input_examples' folder.

# RUNNING THE CODE
In MATLAB, navigate to the 'faults_3D_v1.4' folder. Open the faults_3D script and edit the necessary parameters, then execute the script by entering 'faults_3D' in the command line or pressing F5.

# BUILDING SLIP DISTRIBUTIONS
The code will build simple bulls eye slip distributions according to four different options (which are made as selections when the code is running).
The down-dip extent of the rupture can be controlled by changing the 'rupture_depth' variable.
For all options, the default is that the location of maximum slip is at the centre of the fault. However the location of maximum slip can be changed by altering the 'centre_vertical' and 'centre_horizontal' variables.
1. The whole fault slips. This assumes the slip is zero at the base, zero at the edges and a specified proportion of maximum slip reaches the surface. 
2. Only the central section of the fault slips, a length of rupture will be requested by the code. 
3. Only the north or west end of the fault slips, a length of rupture will be requested by the code. 
4. Only the south or east end of the fault slips, a length of rupture will be requested by the code. 

Alternatively, slip distributions can be manually assigned to each element in the Coulomb input file created from running this code.

# OUTPUTS:
Writes a .inr file which can be used directly in Coulomb 3.4. HOWEVER BEFORE using in Coulomb, the #fixed value needs to be changed in the third line of the file. This file is created in the "Output_files" folder.

The code also calculates the total seismic moment released by the calculated slip distribution, and displays this in the Matlab Command Window. 

# ASSUMPTIONS:
  - the slip vector is preserved down dip
  - the trace at the surface continues to depth
  - the dip of the faults are consistent with depth (i.e. planar, not listric geometry)
  - the slip distribution generated by this code creates a simple bulls eye slip distribution.

For further information, please see the published GRL paper.

Please report any issues or bugs to Zoe Mildon (zoe.mildon.13@ucl.ac.uk, zoe.mildon@plymouth.ac.uk).

# REFERENCES:
This code uses the following functions:

kml2struct_multi version 1.2.1 by Reno Filla (https://uk.mathworks.com/matlabcentral/fileexchange/80083-kml2struct_multi)

kmz2struct version 1.0.0 by Nathan Ellingson (https://uk.mathworks.com/matlabcentral/fileexchange/70450-kmz2struct)

wgs2utm version 1.2.0.0 by Alexandre Schimel (https://uk.mathworks.com/matlabcentral/fileexchange/14804-wgs2utm-version-2)

MATLAB mapping toolbox is required.

